(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6198:function(e,t,a){Promise.resolve().then(a.bind(a,1692))},1692:function(e,t,a){"use strict";a.r(t);var n=a(7437),s=a(29),r=a.n(s),o=a(2265);t.default=function(){let[e,t]=o.useState(new Date),[a,s]=o.useState(!1),[i,l]=o.useState(!1),[d,m]=o.useState("Sed"),[c,f]=o.useState(!1),[h,x]=o.useState(!1),[u,g]=o.useState(null),[w,y]=o.useState({}),[b,p]=o.useState("columns"),[k,D]=o.useState(!1),[j,v]=o.useState(null),[S,M]=o.useState([]),[N,C]=o.useState(!1),J=["January","February","March","April","May","June","July","August","September","October","November","December"],z={"odmor-godisnji":"#ff9966","odmor-bolovanje":"#4a9eff","odmor-slobodan-dan":"#67e8f9",work:"#10b981",meeting:"#8b5cf6",personal:"#f43f5e",islamic:"#fbbf24"};o.useEffect(()=>{E()},[]),o.useEffect(()=>{y({[new Date().toDateString()]:[{id:"1",text:"Team Meeting",category:"meeting",time:"10:00 AM"},{id:"2",text:"Lunch with Client",category:"work",time:"12:30 PM"}],[new Date(Date.now()+864e5).toDateString()]:[{id:"3",text:"Annual Leave",category:"odmor-godisnji",isVacationDay:!0,isStart:!0,date:new Date(Date.now()+864e5),endDate:new Date(Date.now()+432e6)}],[new Date(Date.now()+6048e5).toDateString()]:[{id:"4",text:"Doctor Appointment",category:"odmor-bolovanje",isVacationDay:!0,isStart:!0,date:new Date(Date.now()+6048e5)},{id:"5",text:"Project Deadline",category:"work",time:"5:00 PM"}],[new Date(Date.now()+12096e5).toDateString()]:[{id:"6",text:"Ramadan Start",category:"islamic"}]})},[]);let E=async()=>{try{x(!0);let e=await fetch("/api/get-all-schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),t=await e.json();console.log("Fetched schedules:",t),t.schedules?M(t.schedules):console.error("No schedules found in response:",t)}catch(e){console.error("Error fetching schedules:",e)}finally{x(!1)}},_=(e=>{let t=new Date(e.getFullYear(),e.getMonth(),1),a=new Date(e.getFullYear(),e.getMonth()+1,0),n=t.getDay()||7;n=1===n?0:n-1;let s=new Date(t);s.setDate(s.getDate()-n);let r=new Date(a),o=7-r.getDay();0!==r.getDay()&&r.setDate(r.getDate()+o);let i=[],l=new Date(s);for(;l<=r;){let t=[];for(let a=0;a<7;a++)t.push({day:l.getDate(),date:new Date(l),isPreviousMonth:l.getMonth()<e.getMonth()||11===l.getMonth()&&0===e.getMonth(),isNextMonth:l.getMonth()>e.getMonth()||0===l.getMonth()&&11===e.getMonth()}),l.setDate(l.getDate()+1);i.push(t)}return i})(e),A=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];x(!0),g(null);try{if(await new Promise(e=>setTimeout(e,1e3)),e){let e=new Date(Date.now()+18144e5).toDateString();y(t=>({...t,[e]:[{id:"7",text:"Conference",category:"work",time:"9:00 AM - 5:00 PM"}]}))}}catch(e){g("Failed to load events. Please try again.")}finally{x(!1)}},P=(e,t)=>!!S&&0!==S.length&&S.some(a=>a.week_start_date===e&&a.week_end_date===t),T=async(e,t,a)=>{console.log("handleWeekClick called with:",e,t,a);let n=t.toISOString().split("T")[0],s=a.toISOString().split("T")[0];if(P(n,s)){C(!0);try{console.log("Fetching schedule for:",n,s);let t=await fetch("/api/get-schedule-by-week-dates",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({startDate:n,endDate:s})}),a=await t.json();console.log("Schedule data received:",a),a.error?console.error("Failed to fetch schedule:",a.error):(v({month:a.scheduleInfo.month,year:a.scheduleInfo.year,dateRange:a.scheduleInfo.date_range,schedule:a.schedule,weekNumber:e,weekStartDate:n,weekEndDate:s}),D(!0))}catch(e){console.error("Error fetching schedule:",e)}finally{C(!1)}}},F=async e=>{try{C(!0);let t=await fetch("/api/update-schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scheduleId:e.scheduleId,weekNumber:e.weekNumber,year:e.year,weekStartDate:e.weekStartDate,weekEndDate:e.weekEndDate,dateRange:e.dateRange,schedule:e.schedule})}),a=await t.json();a.success?(console.log("Schedule updated successfully:",a),D(!1),E()):console.error("Failed to update schedule:",a.message)}catch(e){console.error("Error updating schedule:",e)}finally{C(!1)}},O=i||c;if(k&&j){let e=S.map(e=>({weekNumber:e.week_number,year:e.year,dateRange:e.date_range}));return(0,n.jsx)("div",{className:"min-h-screen font-inter p-3 sm:p-4 md:p-6 lg:p-8 flex flex-col overflow-y-auto bg-[#121214]",children:(0,n.jsxs)("div",{className:"w-full max-w-[99%] mx-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsxs)("h1",{className:"text-xl sm:text-2xl font-bold text-white",children:["Schedule for Week ",j.weekNumber," (",j.dateRange,")"]}),(0,n.jsxs)("button",{onClick:()=>{D(!1)},className:"bg-[#1D1D1F] hover:bg-[#2a2a2a] text-[#67e8f9] px-4 py-2 rounded-lg flex items-center",children:[(0,n.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back to Calendar"]})]}),(0,n.jsx)(BinBinWithSingleHeader,{operators:["John Doe","Jane Smith","Mark Johnson"],data:j.schedule||[{date:"01.01",day:"P",shifts:[{time:"08.00-16.00",operators:{"M58-J-467":"John Doe","M53-E-929":"Jane Smith","A35-J-924":""}},{time:"20.00-04.00",operators:{"M58-J-467":"","M53-E-929":"Mark Johnson","A35-J-924":""}}]},{date:"02.01",day:"U",shifts:[{time:"08.00-16.00",operators:{"M58-J-467":"Jane Smith","M53-E-929":"","A35-J-924":"John Doe"}},{time:"20.00-04.00",operators:{"M58-J-467":"Mark Johnson","M53-E-929":"","A35-J-924":""}}]}],availableWeeks:e,initialWeek:{weekNumber:j.weekNumber,year:j.year,dateRange:j.dateRange},onSave:e=>{console.log("Saving schedule data:",e),F({...j,schedule:e})},onWeekChange:e=>{console.log("Week changed:",e);let t=S.find(t=>t.week_number===e.weekNumber&&t.year===e.year);if(t){let a=new Date(t.week_start_date),n=new Date(t.week_end_date);T(e.weekNumber,a,n)}}})]})})}return(0,n.jsxs)("div",{style:{backgroundImage:"url('https://ucarecdn.com/220aeb18-08cb-4769-a57d-b8bbb8f89791/-/format/auto/')",backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed",backgroundRepeat:"no-repeat",maxHeight:"100vh"},className:"jsx-77009c86862f3707 min-h-screen font-inter p-3 sm:p-4 md:p-6 lg:p-8 flex flex-col overflow-y-auto",children:[N&&(0,n.jsx)("div",{className:"jsx-77009c86862f3707 fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:(0,n.jsx)("div",{className:"jsx-77009c86862f3707 animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-[#67e8f9]"})}),(0,n.jsxs)("div",{className:"jsx-77009c86862f3707 w-full max-w-[99%] mx-auto rounded-xl px-1 py-[6px] sm:p-1 md:py-2 md:px-1 lg:py-3 lg:px-2 shadow-2xl mt-1 sm:mt-2 md:mt-3",children:[(0,n.jsx)(CalHeader,{currentDate:e,setCurrentDate:t,setShowMonthPicker:s,navigateMonth:a=>{let n=new Date(e);n.setMonth(n.getMonth()+a),t(n)},monthNames:J,selectedIcon:b,setSelectedIcon:p,toggleMiniCalendar:()=>l(!i),showMiniCalendar:i,events:w,categoryColors:z}),(0,n.jsx)("div",{className:"jsx-77009c86862f3707 my-2 sm:my-2.5 md:my-3 overflow-x-auto",children:(0,n.jsx)("div",{className:"jsx-77009c86862f3707 min-w-[320px] w-full",children:(0,n.jsx)(CalGrid1,{weeks:_,dayNames:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],buttonText:d,handleDayClick:(e,t)=>{console.log("Day clicked:",t)},handleWeekClick:T,events:w,currentDate:e,categoryColors:z,getISOWeekNumber:e=>{let t=new Date(e);t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);let a=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-a.getTime())/864e5-3+(a.getDay()+6)%7)/7)}})})}),(0,n.jsx)("div",{className:"jsx-77009c86862f3707 mt-2 sm:mt-2.5 md:mt-3",children:(0,n.jsx)(CalFooter,{showEvents:c,setShowEvents:f,loading:h,fetchEvents:A,error:u,events:w,handleDeleteEvent:e=>{let t={};Object.entries(w).forEach(a=>{let[n,s]=a,r=s.filter(t=>t.id!==e);r.length>0&&(t[n]=r)}),y(t)},categoryColors:z})})]}),a&&(0,n.jsx)("div",{onClick:()=>s(!1),className:"jsx-77009c86862f3707 fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{onClick:e=>e.stopPropagation(),className:"jsx-77009c86862f3707 bg-[#1D1D1F] rounded-lg p-3 sm:p-4 w-[280px] sm:w-[320px] md:w-[360px] max-w-[90vw]",children:[(0,n.jsx)("h3",{className:"jsx-77009c86862f3707 text-white text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:"Select Month"}),(0,n.jsx)("div",{className:"jsx-77009c86862f3707 grid grid-cols-3 gap-1 sm:gap-2",children:J.map((a,r)=>(0,n.jsx)("button",{onClick:()=>{let a=new Date(e);a.setMonth(r),t(a),s(!1)},className:"jsx-77009c86862f3707 bg-[#2A2A2A] hover:bg-[#3A3A3A] text-white text-xs sm:text-sm py-1.5 sm:py-2 rounded transition-colors",children:a},a))})]})}),i&&(0,n.jsx)("div",{className:"jsx-77009c86862f3707 mt-4",children:(0,n.jsx)("div",{className:"jsx-77009c86862f3707 bg-[#1a1a1a] rounded-lg p-2 border border-[#2a2a2a]",children:(0,n.jsx)(MiniCalendars,{currentDate:e,events:w,categoryColors:z})})}),O&&(0,n.jsx)("div",{className:"jsx-77009c86862f3707 pb-20"}),(0,n.jsx)(r(),{id:"77009c86862f3707",children:"@-webkit-keyframes vibrate{0%{-webkit-transform:translatex(0);transform:translatex(0)}25%{-webkit-transform:translatex(.5px);transform:translatex(.5px)}50%{-webkit-transform:translatex(0);transform:translatex(0)}75%{-webkit-transform:translatex(-.5px);transform:translatex(-.5px)}100%{-webkit-transform:translatex(0);transform:translatex(0)}}@-moz-keyframes vibrate{0%{-moz-transform:translatex(0);transform:translatex(0)}25%{-moz-transform:translatex(.5px);transform:translatex(.5px)}50%{-moz-transform:translatex(0);transform:translatex(0)}75%{-moz-transform:translatex(-.5px);transform:translatex(-.5px)}100%{-moz-transform:translatex(0);transform:translatex(0)}}@-o-keyframes vibrate{0%{-o-transform:translatex(0);transform:translatex(0)}25%{-o-transform:translatex(.5px);transform:translatex(.5px)}50%{-o-transform:translatex(0);transform:translatex(0)}75%{-o-transform:translatex(-.5px);transform:translatex(-.5px)}100%{-o-transform:translatex(0);transform:translatex(0)}}@keyframes vibrate{0%{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0)}25%{-webkit-transform:translatex(.5px);-moz-transform:translatex(.5px);-o-transform:translatex(.5px);transform:translatex(.5px)}50%{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0)}75%{-webkit-transform:translatex(-.5px);-moz-transform:translatex(-.5px);-o-transform:translatex(-.5px);transform:translatex(-.5px)}100%{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0)}}.vibrate{-webkit-animation:vibrate.3s infinite;-moz-animation:vibrate.3s infinite;-o-animation:vibrate.3s infinite;animation:vibrate.3s infinite}@-webkit-keyframes fade-in{from{opacity:0}to{opacity:1}}@-moz-keyframes fade-in{from{opacity:0}to{opacity:1}}@-o-keyframes fade-in{from{opacity:0}to{opacity:1}}@keyframes fade-in{from{opacity:0}to{opacity:1}}.animate-fade-in{-webkit-animation:fade-in.3s ease-in-out;-moz-animation:fade-in.3s ease-in-out;-o-animation:fade-in.3s ease-in-out;animation:fade-in.3s ease-in-out}@-webkit-keyframes slide-right{from{width:0}to{width:100%}}@-moz-keyframes slide-right{from{width:0}to{width:100%}}@-o-keyframes slide-right{from{width:0}to{width:100%}}@keyframes slide-right{from{width:0}to{width:100%}}@-webkit-keyframes slide-left{from{width:100%}to{width:0}}@-moz-keyframes slide-left{from{width:100%}to{width:0}}@-o-keyframes slide-left{from{width:100%}to{width:0}}@keyframes slide-left{from{width:100%}to{width:0}}.slide-right{-webkit-animation:slide-right.3s ease-in-out;-moz-animation:slide-right.3s ease-in-out;-o-animation:slide-right.3s ease-in-out;animation:slide-right.3s ease-in-out}.slide-left{-webkit-animation:slide-left.3s ease-in-out;-moz-animation:slide-left.3s ease-in-out;-o-animation:slide-left.3s ease-in-out;animation:slide-left.3s ease-in-out}html,body{height:100%;overflow:auto}"})]})}}},function(e){e.O(0,[29,971,117,744],function(){return e(e.s=6198)}),_N_E=e.O()}]);